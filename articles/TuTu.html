<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="coconatfly">
<title>2. Clustering TuTu neurons • coconatfly</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="2. Clustering TuTu neurons">
<meta property="og:description" content="coconatfly">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">coconatfly</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/flyconnectome/coconatfly/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="TuTu_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>2. Clustering TuTu neurons</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/flyconnectome/coconatfly/blob/HEAD/vignettes/TuTu.Rmd" class="external-link"><code>vignettes/TuTu.Rmd</code></a></small>
      <div class="d-none name"><code>TuTu.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This short article gives an example of across dataset connectivity clustering using the <a href="https://flywire.ai/" class="external-link">flywire</a> and <a href="https://www.janelia.org/project-team/flyem/hemibrain" class="external-link">hemibrain</a> datasets. This provides support for specific neuronal cell types first proposed in the hemibrain.</p>
<p>TuTu neurons are a class of visual interneurons that connect the two optic tubercles on each side of the brain. Inputs to the tubercle include narrow field visual interneurons e.g. those responsive to small objects such as other flies. You can read more about them on VFB, where they are called <a href="https://v2.virtualflybrain.org/org.geppetto.frontend/geppetto?id=FBbt_00051062&amp;i=VFB_00101567,VFB_jrchk7cz" class="external-link"><code>adult tubercle-tubercle neuron</code> [FBbt_00051062]</a>.</p>
<p>There are 4 TuTu neurons originating from each hemisphere (8 per brain). The TuTuA neurons have larger arborisations in the medial part of the optic tubercle; the TuTuB neurons have smaller arbours in the more lateral part. You can examine them in 3D using this <a href="https://neuroglancer-demo.appspot.com/#!%7B%22title%22:%22flywire-hemibrain%22%2C%22dimensions%22:%7B%22x%22:%5B4e-9%2C%22m%22%5D%2C%22y%22:%5B4e-9%2C%22m%22%5D%2C%22z%22:%5B4e-8%2C%22m%22%5D%7D%2C%22position%22:%5B136278.5%2C56063.5%2C436.5%5D%2C%22crossSectionScale%22:1.2071%2C%22projectionOrientation%22:%5B-0.023625720292329788%2C0.0059402878396213055%2C0.018635405227541924%2C0.9995295405387878%5D%2C%22projectionScale%22:90711.54637016413%2C%22projectionDepth%22:-88744875287147.48%2C%22layers%22:%5B%7B%22type%22:%22image%22%2C%22source%22:%22precomputed://gs://flywire_em/aligned/v1%22%2C%22tab%22:%22source%22%2C%22name%22:%22image_data%22%7D%2C%7B%22type%22:%22segmentation%22%2C%22source%22:%5B%7B%22url%22:%22precomputed://gs://flywire_v141_m630%22%2C%22subsources%22:%7B%22default%22:true%2C%22mesh%22:true%7D%2C%22enableDefaultSubsources%22:false%7D%2C%22precomputed://https://flyem.mrc-lmb.cam.ac.uk/flyconnectome/dynann/flytable-info-630%22%5D%2C%22tab%22:%22segments%22%2C%22segments%22:%5B%22720575940612218547%22%2C%22720575940614041238%22%2C%22720575940622538520%22%2C%22720575940623326868%22%2C%22720575940633550431%22%2C%22720575940635979000%22%2C%22720575940637997427%22%2C%22720575940621226846%22%5D%2C%22segmentQuery%22:%22TuTu%22%2C%22colorSeed%22:975507960%2C%22name%22:%22flywire%22%7D%2C%7B%22type%22:%22segmentation%22%2C%22source%22:%22precomputed://https://spine.itanna.io/files/data/hemibrain2flywire/precomputed/neuronmeshes/mesh#type=mesh%22%2C%22tab%22:%22segments%22%2C%22segments%22:%5B%22%21676836779%22%2C%22%215813013691%22%2C%22%21708290604%22%2C%22%21925008763%22%2C%22%21770226597%22%2C%225813014028%22%2C%22%21987759904%22%2C%22769544445%22%5D%2C%22segmentQuery%22:%22TuTu%22%2C%22colorSeed%22:2407669673%2C%22name%22:%22hemibrain_meshes%22%7D%2C%7B%22type%22:%22segmentation%22%2C%22source%22:%5B%22precomputed://https://spine.itanna.io/files/data/hemibrain2flywire_mirror/precomputed/neuronmeshes/mesh#type=mesh%22%2C%7B%22url%22:%22precomputed://https://spine.itanna.io/files/data/hemibrain2flywire/precomputed/neuronmeshes/mesh%22%2C%22subsources%22:%7B%22properties%22:true%7D%2C%22enableDefaultSubsources%22:false%7D%5D%2C%22tab%22:%22segments%22%2C%22segments%22:%5B%22676836779%22%2C%225813013691%22%2C%22708290604%22%2C%22925008763%22%2C%22770226597%22%2C%225813014028%22%2C%22987759904%22%2C%22769544445%22%5D%2C%22segmentQuery%22:%22TuTu%22%2C%22colorSeed%22:2407669673%2C%22name%22:%22hemibrain_meshes_mirr%22%2C%22visible%22:false%7D%2C%7B%22type%22:%22segmentation%22%2C%22source%22:%22precomputed://gs://flywire_neuropil_meshes/neuropils/neuropil_mesh_v141_v3%22%2C%22tab%22:%22segments%22%2C%22selectedAlpha%22:0.2%2C%22objectAlpha%22:0.2%2C%22segments%22:%5B%220%22%2C%221%22%2C%2210%22%2C%2211%22%2C%2212%22%2C%2213%22%2C%2214%22%2C%2215%22%2C%2216%22%2C%2217%22%2C%2218%22%2C%2219%22%2C%222%22%2C%2220%22%2C%2221%22%2C%2222%22%2C%2223%22%2C%2224%22%2C%2225%22%2C%2226%22%2C%2227%22%2C%2228%22%2C%2229%22%2C%223%22%2C%2230%22%2C%2231%22%2C%2232%22%2C%2233%22%2C%2234%22%2C%2235%22%2C%2236%22%2C%2237%22%2C%2238%22%2C%2239%22%2C%224%22%2C%2240%22%2C%2241%22%2C%2242%22%2C%2243%22%2C%2244%22%2C%2245%22%2C%2246%22%2C%2247%22%2C%2248%22%2C%2249%22%2C%225%22%2C%2250%22%2C%2251%22%2C%2252%22%2C%2253%22%2C%2254%22%2C%2255%22%2C%2256%22%2C%2257%22%2C%2258%22%2C%2259%22%2C%226%22%2C%2260%22%2C%2261%22%2C%2262%22%2C%2263%22%2C%2264%22%2C%2265%22%2C%2266%22%2C%2267%22%2C%2268%22%2C%2269%22%2C%227%22%2C%2270%22%2C%2271%22%2C%2272%22%2C%2273%22%2C%2274%22%2C%2275%22%2C%2276%22%2C%2277%22%2C%2278%22%2C%228%22%2C%229%22%5D%2C%22name%22:%22neuropil_mesh_v141_v3%22%2C%22visible%22:false%7D%2C%7B%22type%22:%22segmentation%22%2C%22source%22:%22precomputed://https://flyem.mrc-lmb.cam.ac.uk/flyconnectome/brain_mesh%22%2C%22tab%22:%22source%22%2C%22objectAlpha%22:0.28%2C%22segments%22:%5B%220%22%2C%221%22%5D%2C%22segmentColors%22:%7B%220%22:%22#6b6b6b%22%2C%221%22:%22#6b6b6b%22%7D%2C%22name%22:%22flywire_brain_mesh%22%7D%2C%7B%22type%22:%22segmentation%22%2C%22source%22:%22precomputed://https://spine.itanna.io/files/data/hemibrain2flywire/precomputed/neuropils/mesh#type=mesh%22%2C%22tab%22:%22source%22%2C%22objectAlpha%22:0.16%2C%22segments%22:%5B%22200%22%5D%2C%22colorSeed%22:422627114%2C%22segmentColors%22:%7B%22200%22:%22#e0e0e0%22%7D%2C%22name%22:%22hemibrain_neuropils%22%2C%22visible%22:false%7D%5D%2C%22showAxisLines%22:false%2C%22showScaleBar%22:false%2C%22selectedLayer%22:%7B%22visible%22:true%2C%22layer%22:%22flywire%22%7D%2C%22layout%22:%223d%22%7D" class="external-link">cocoglancer scene</a> (cocoglancer is an across-dataset configuration of the <a href="https://github.com/google/neuroglancer" class="external-link">neuroglancer</a> web app described <a href="https://github.com/flyconnectome/flywire_annotations/tree/main/cocoglancer#readme" class="external-link">here</a>).</p>
<p><a href="https://neuroglancer-demo.appspot.com/#!%7B%22title%22:%22flywire-hemibrain%22%2C%22dimensions%22:%7B%22x%22:%5B4e-9%2C%22m%22%5D%2C%22y%22:%5B4e-9%2C%22m%22%5D%2C%22z%22:%5B4e-8%2C%22m%22%5D%7D%2C%22position%22:%5B136278.5%2C56063.5%2C436.5%5D%2C%22crossSectionScale%22:1.2071%2C%22projectionOrientation%22:%5B-0.023625720292329788%2C0.0059402878396213055%2C0.018635405227541924%2C0.9995295405387878%5D%2C%22projectionScale%22:90711.54637016413%2C%22projectionDepth%22:-88744875287147.48%2C%22layers%22:%5B%7B%22type%22:%22image%22%2C%22source%22:%22precomputed://gs://flywire_em/aligned/v1%22%2C%22tab%22:%22source%22%2C%22name%22:%22image_data%22%7D%2C%7B%22type%22:%22segmentation%22%2C%22source%22:%5B%7B%22url%22:%22precomputed://gs://flywire_v141_m630%22%2C%22subsources%22:%7B%22default%22:true%2C%22mesh%22:true%7D%2C%22enableDefaultSubsources%22:false%7D%2C%22precomputed://https://flyem.mrc-lmb.cam.ac.uk/flyconnectome/dynann/flytable-info-630%22%5D%2C%22tab%22:%22segments%22%2C%22segments%22:%5B%22720575940612218547%22%2C%22720575940614041238%22%2C%22720575940622538520%22%2C%22720575940623326868%22%2C%22720575940633550431%22%2C%22720575940635979000%22%2C%22720575940637997427%22%2C%22720575940621226846%22%5D%2C%22segmentQuery%22:%22TuTu%22%2C%22colorSeed%22:975507960%2C%22name%22:%22flywire%22%7D%2C%7B%22type%22:%22segmentation%22%2C%22source%22:%22precomputed://https://spine.itanna.io/files/data/hemibrain2flywire/precomputed/neuronmeshes/mesh#type=mesh%22%2C%22tab%22:%22segments%22%2C%22segments%22:%5B%22%21676836779%22%2C%22%215813013691%22%2C%22%21708290604%22%2C%22%21925008763%22%2C%22%21770226597%22%2C%225813014028%22%2C%22%21987759904%22%2C%22769544445%22%5D%2C%22segmentQuery%22:%22TuTu%22%2C%22colorSeed%22:2407669673%2C%22name%22:%22hemibrain_meshes%22%7D%2C%7B%22type%22:%22segmentation%22%2C%22source%22:%5B%22precomputed://https://spine.itanna.io/files/data/hemibrain2flywire_mirror/precomputed/neuronmeshes/mesh#type=mesh%22%2C%7B%22url%22:%22precomputed://https://spine.itanna.io/files/data/hemibrain2flywire/precomputed/neuronmeshes/mesh%22%2C%22subsources%22:%7B%22properties%22:true%7D%2C%22enableDefaultSubsources%22:false%7D%5D%2C%22tab%22:%22segments%22%2C%22segments%22:%5B%22676836779%22%2C%225813013691%22%2C%22708290604%22%2C%22925008763%22%2C%22770226597%22%2C%225813014028%22%2C%22987759904%22%2C%22769544445%22%5D%2C%22segmentQuery%22:%22TuTu%22%2C%22colorSeed%22:2407669673%2C%22name%22:%22hemibrain_meshes_mirr%22%2C%22visible%22:false%7D%2C%7B%22type%22:%22segmentation%22%2C%22source%22:%22precomputed://gs://flywire_neuropil_meshes/neuropils/neuropil_mesh_v141_v3%22%2C%22tab%22:%22segments%22%2C%22selectedAlpha%22:0.2%2C%22objectAlpha%22:0.2%2C%22segments%22:%5B%220%22%2C%221%22%2C%2210%22%2C%2211%22%2C%2212%22%2C%2213%22%2C%2214%22%2C%2215%22%2C%2216%22%2C%2217%22%2C%2218%22%2C%2219%22%2C%222%22%2C%2220%22%2C%2221%22%2C%2222%22%2C%2223%22%2C%2224%22%2C%2225%22%2C%2226%22%2C%2227%22%2C%2228%22%2C%2229%22%2C%223%22%2C%2230%22%2C%2231%22%2C%2232%22%2C%2233%22%2C%2234%22%2C%2235%22%2C%2236%22%2C%2237%22%2C%2238%22%2C%2239%22%2C%224%22%2C%2240%22%2C%2241%22%2C%2242%22%2C%2243%22%2C%2244%22%2C%2245%22%2C%2246%22%2C%2247%22%2C%2248%22%2C%2249%22%2C%225%22%2C%2250%22%2C%2251%22%2C%2252%22%2C%2253%22%2C%2254%22%2C%2255%22%2C%2256%22%2C%2257%22%2C%2258%22%2C%2259%22%2C%226%22%2C%2260%22%2C%2261%22%2C%2262%22%2C%2263%22%2C%2264%22%2C%2265%22%2C%2266%22%2C%2267%22%2C%2268%22%2C%2269%22%2C%227%22%2C%2270%22%2C%2271%22%2C%2272%22%2C%2273%22%2C%2274%22%2C%2275%22%2C%2276%22%2C%2277%22%2C%2278%22%2C%228%22%2C%229%22%5D%2C%22name%22:%22neuropil_mesh_v141_v3%22%2C%22visible%22:false%7D%2C%7B%22type%22:%22segmentation%22%2C%22source%22:%22precomputed://https://flyem.mrc-lmb.cam.ac.uk/flyconnectome/brain_mesh%22%2C%22tab%22:%22source%22%2C%22objectAlpha%22:0.28%2C%22segments%22:%5B%220%22%2C%221%22%5D%2C%22segmentColors%22:%7B%220%22:%22#6b6b6b%22%2C%221%22:%22#6b6b6b%22%7D%2C%22name%22:%22flywire_brain_mesh%22%7D%2C%7B%22type%22:%22segmentation%22%2C%22source%22:%22precomputed://https://spine.itanna.io/files/data/hemibrain2flywire/precomputed/neuropils/mesh#type=mesh%22%2C%22tab%22:%22source%22%2C%22objectAlpha%22:0.16%2C%22segments%22:%5B%22200%22%5D%2C%22colorSeed%22:422627114%2C%22segmentColors%22:%7B%22200%22:%22#e0e0e0%22%7D%2C%22name%22:%22hemibrain_neuropils%22%2C%22visible%22:false%7D%5D%2C%22showAxisLines%22:false%2C%22showScaleBar%22:false%2C%22selectedLayer%22:%7B%22visible%22:true%2C%22layer%22:%22flywire%22%7D%2C%22layout%22:%223d%22%7D" class="external-link"><img src="TuTu_neurons.png"></a></p>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>If this is your first time using coconatfly, some additional setup is required beyond package installation. Please see the <a href="https://natverse.org/coconatfly/articles/getting-started.html" class="external-link">getting started vignette</a> for details of downloading / authenticating to connectome data sources.</p>
</div>
</div>
<div class="section level2">
<h2 id="fetching-the-neurons">Fetching the neurons<a class="anchor" aria-label="anchor" href="#fetching-the-neurons"></a>
</h2>
<p>OK with that preamble, let’s get started. First we need to load two required libraries.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/flyconnectome/coconatfly" class="external-link">coconatfly</a></span><span class="op">)</span></span></code></pre></div>
<p>The following TuTu neurons are recorded in the hemibrain and FAFB-FlyWire. Note the use of a regular expression (introduced by <code>/</code>) to match against the type field. <code>.*</code> means any number of characters can follow TuTu in the type name.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tutus</span><span class="op">=</span><span class="fu"><a href="../reference/cf_meta.html">cf_meta</a></span><span class="op">(</span><span class="fu"><a href="../reference/cf_ids.html">cf_ids</a></span><span class="op">(</span><span class="st">'/type:TuTu.*'</span>, datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hemibrain"</span>, <span class="st">"flywire"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required namespace: git2r</span></span>
<span><span class="va">tutus</span></span>
<span><span class="co">#&gt;                    id side   class    type group         instance   dataset</span></span>
<span><span class="co">#&gt; 1  720575940621226846    L central   TuTuA  &lt;NA&gt;          TuTuA_L   flywire</span></span>
<span><span class="co">#&gt; 2  720575940633550431    R central TuTuB_a  &lt;NA&gt;        TuTuB_a_R   flywire</span></span>
<span><span class="co">#&gt; 3  720575940612218547    L central   TuTuA  &lt;NA&gt;          TuTuA_L   flywire</span></span>
<span><span class="co">#&gt; 4  720575940635979000    L central TuTuB_b  &lt;NA&gt;        TuTuB_b_L   flywire</span></span>
<span><span class="co">#&gt; 5  720575940637997427    R central TuTuB_b  &lt;NA&gt;        TuTuB_b_R   flywire</span></span>
<span><span class="co">#&gt; 6  720575940623326868    L central TuTuB_a  &lt;NA&gt;        TuTuB_a_L   flywire</span></span>
<span><span class="co">#&gt; 7  720575940614041238    R central   TuTuA  &lt;NA&gt;          TuTuA_R   flywire</span></span>
<span><span class="co">#&gt; 8  720575940622538520    R central   TuTuA  &lt;NA&gt;          TuTuA_R   flywire</span></span>
<span><span class="co">#&gt; 9          5813013691    L    &lt;NA&gt;   TuTuA  &lt;NA&gt;   TuTuA(ADL19)_L hemibrain</span></span>
<span><span class="co">#&gt; 10          676836779    L    &lt;NA&gt;   TuTuA  &lt;NA&gt;   TuTuA(ADL19)_L hemibrain</span></span>
<span><span class="co">#&gt; 11          708290604    R    &lt;NA&gt;   TuTuA  &lt;NA&gt;          TuTuA_R hemibrain</span></span>
<span><span class="co">#&gt; 12          925008763    R    &lt;NA&gt;   TuTuA  &lt;NA&gt;          TuTuA_R hemibrain</span></span>
<span><span class="co">#&gt; 13         5813014028    R    &lt;NA&gt; TuTuB_a  &lt;NA&gt;        TuTuB_a_R hemibrain</span></span>
<span><span class="co">#&gt; 14          770226597    L    &lt;NA&gt; TuTuB_a  &lt;NA&gt; TuTuB_a(ADL19)_L hemibrain</span></span>
<span><span class="co">#&gt; 15          769544445    R    &lt;NA&gt; TuTuB_b  &lt;NA&gt;        TuTuB_b_R hemibrain</span></span>
<span><span class="co">#&gt; 16          987759904    L    &lt;NA&gt; TuTuB_b  &lt;NA&gt; TuTuB_b(ADL19)_L hemibrain</span></span>
<span><span class="co">#&gt;                      key</span></span>
<span><span class="co">#&gt; 1  fw:720575940621226846</span></span>
<span><span class="co">#&gt; 2  fw:720575940633550431</span></span>
<span><span class="co">#&gt; 3  fw:720575940612218547</span></span>
<span><span class="co">#&gt; 4  fw:720575940635979000</span></span>
<span><span class="co">#&gt; 5  fw:720575940637997427</span></span>
<span><span class="co">#&gt; 6  fw:720575940623326868</span></span>
<span><span class="co">#&gt; 7  fw:720575940614041238</span></span>
<span><span class="co">#&gt; 8  fw:720575940622538520</span></span>
<span><span class="co">#&gt; 9          hb:5813013691</span></span>
<span><span class="co">#&gt; 10          hb:676836779</span></span>
<span><span class="co">#&gt; 11          hb:708290604</span></span>
<span><span class="co">#&gt; 12          hb:925008763</span></span>
<span><span class="co">#&gt; 13         hb:5813014028</span></span>
<span><span class="co">#&gt; 14          hb:770226597</span></span>
<span><span class="co">#&gt; 15          hb:769544445</span></span>
<span><span class="co">#&gt; 16          hb:987759904</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tutus</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">type</span>, <span class="va">side</span><span class="op">)</span></span>
<span><span class="co">#&gt;      dataset    type side n</span></span>
<span><span class="co">#&gt; 1    flywire   TuTuA    L 2</span></span>
<span><span class="co">#&gt; 2    flywire   TuTuA    R 2</span></span>
<span><span class="co">#&gt; 3    flywire TuTuB_a    L 1</span></span>
<span><span class="co">#&gt; 4    flywire TuTuB_a    R 1</span></span>
<span><span class="co">#&gt; 5    flywire TuTuB_b    L 1</span></span>
<span><span class="co">#&gt; 6    flywire TuTuB_b    R 1</span></span>
<span><span class="co">#&gt; 7  hemibrain   TuTuA    L 2</span></span>
<span><span class="co">#&gt; 8  hemibrain   TuTuA    R 2</span></span>
<span><span class="co">#&gt; 9  hemibrain TuTuB_a    L 1</span></span>
<span><span class="co">#&gt; 10 hemibrain TuTuB_a    R 1</span></span>
<span><span class="co">#&gt; 11 hemibrain TuTuB_b    L 1</span></span>
<span><span class="co">#&gt; 12 hemibrain TuTuB_b    R 1</span></span></code></pre></div>
<p>So we can see the hemibrain TuTuB neurons have been typed into two subtypes, but the flywire neurons have not. We can run across-dataset cosine connectivity clustering on these neurons like so:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tutus</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/cf_cosine_plot.html">cf_cosine_plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Matching types across datasets. Dropping 1300/1922 output partner types with total weight 20970/34391</span></span>
<span><span class="co">#&gt; Matching types across datasets. Dropping 1516/2370 input partner types with total weight 25651/43977</span></span>
<span><span class="co">#&gt; Warning in Matrix::cov2cor(cpx): diag(.) had 0 or NA entries; non-finite result</span></span>
<span><span class="co">#&gt; is doubtful</span></span></code></pre></div>
<p><img src="TuTu_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>So this is interesting at a couple of levels. First we can see that the TuTuB hemibrain neurons separate into two groups. This is true even though things are a bit messy for the <code>TuTuB_a_hbL</code> neuron which will almost certainly be heavily truncated as it has its soma on the left hand (missing) side of the hemibrain.</p>
<p>We can also see the flywire neurons also split up nicely. So we have two groups of four neurons each. Each group contains one neuron from each hemisphere x dataset combination. So we can update our flywire cell typing to match the hemibrain TuTuB_a and TuTuB_b groups.</p>
<div class="section level3">
<h3 id="tutua">TuTuA<a class="anchor" aria-label="anchor" href="#tutua"></a>
</h3>
<p>However, interestingly we can also see that the TuTuA group splits very strongly in flywire into two groups that are not evident in the hemibrain. To me this strongly suggests that some property of the bilateral connectivity defines this difference.</p>
<p>We can try seeing if we just use the input connectivity to cluster if things resolve:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tutus</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"TuTuA"</span>, <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/cf_cosine_plot.html">cf_cosine_plot</a></span><span class="op">(</span>partners <span class="op">=</span> <span class="st">'in'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Matching types across datasets. Dropping 888/1709 input partner types with total weight 18225/35561</span></span></code></pre></div>
<p><img src="TuTu_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Hmm the situation is still the same. Since the two flywire groups are so well-separated this is almost certainly a real split. In fact there is a candidate anatomical difference in the placement of the contralateral axons that clearly correlates with this split.</p>
<div class="figure">
<img src="TuTuA_L.png" alt=""><p class="caption">TuTuA neurons from the LHS of FlyWire</p>
</div>
<div class="figure">
<img src="TuTuA_R.png" alt=""><p class="caption">TuTuA neurons from the LHS of FlyWire</p>
</div>
<p>This candidate axonal difference is even visible in the hemibrain.</p>
<div class="figure">
<img src="TuTuA_L-hb.png" alt=""><p class="caption">TuTuA neurons from the LHS of FlyWire</p>
</div>
<p>However since the across-brain connectivity clustering does not yet support this (likely owing to a lack of shared labelled partner neurons), I will not record the split for now. I strongly suspect that we will observe this split in future connectomes though.</p>
</div>
</div>
<div class="section level2">
<h2 id="setting-the-new-types">Setting the new types<a class="anchor" aria-label="anchor" href="#setting-the-new-types"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tutus.hc</span> <span class="op">&lt;-</span> <span class="va">tutus</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/cf_cosine_plot.html">cf_cosine_plot</a></span><span class="op">(</span>heatmap <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">#&gt; Matching types across datasets. Dropping 1300/1922 output partner types with total weight 20970/34391</span></span>
<span><span class="co">#&gt; Matching types across datasets. Dropping 1516/2370 input partner types with total weight 25651/43977</span></span>
<span><span class="co">#&gt; Warning in Matrix::cov2cor(cpx): diag(.) had 0 or NA entries; non-finite result</span></span>
<span><span class="co">#&gt; is doubtful</span></span>
<span><span class="va">tutus.meta</span><span class="op">=</span><span class="fu"><a href="../reference/cf_meta.html">cf_meta</a></span><span class="op">(</span><span class="va">tutus.hc</span><span class="op">$</span><span class="va">labels</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tutus.hc</span>, labels <span class="op">=</span> <span class="va">tutus.meta</span><span class="op">$</span><span class="va">type</span><span class="op">)</span></span></code></pre></div>
<p><img src="TuTu_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tutus.meta2</span><span class="op">=</span><span class="fu">coconat</span><span class="fu">::</span><span class="fu"><a href="https://natverse.org/coconat/reference/add_cluster_info.html" class="external-link">add_cluster_info</a></span><span class="op">(</span><span class="va">tutus.meta</span>, <span class="va">tutus.hc</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in coconat::add_cluster_info(tutus.meta, tutus.hc, k = 5): Multiple standard id columns are present in tutus.meta</span></span>
<span><span class="co">#&gt; Choosing key</span></span>
<span><span class="va">tutus.meta2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">group_k5</span><span class="op">)</span></span>
<span><span class="co">#&gt;     dataset group_k5 n</span></span>
<span><span class="co">#&gt; 1   flywire        1 2</span></span>
<span><span class="co">#&gt; 2   flywire        2 2</span></span>
<span><span class="co">#&gt; 3   flywire        4 2</span></span>
<span><span class="co">#&gt; 4   flywire        5 2</span></span>
<span><span class="co">#&gt; 5 hemibrain        1 2</span></span>
<span><span class="co">#&gt; 6 hemibrain        2 2</span></span>
<span><span class="co">#&gt; 7 hemibrain        3 4</span></span></code></pre></div>
<p>Group 4 contains the TuTuB_b neurons</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tutus.meta2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group_k5</span><span class="op">==</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   id side   class  type group instance dataset</span></span>
<span><span class="co">#&gt; 1 720575940614041238    R central TuTuA  &lt;NA&gt;  TuTuA_R flywire</span></span>
<span><span class="co">#&gt; 2 720575940612218547    L central TuTuA  &lt;NA&gt;  TuTuA_L flywire</span></span>
<span><span class="co">#&gt;                     key dendid group_k5</span></span>
<span><span class="co">#&gt; 1 fw:720575940614041238     13        4</span></span>
<span><span class="co">#&gt; 2 fw:720575940612218547     14        4</span></span></code></pre></div>
<p>Group 5 contains the TuTuB_b neurons</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tutus.meta2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group_k5</span><span class="op">==</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   id side   class  type group instance dataset</span></span>
<span><span class="co">#&gt; 1 720575940622538520    R central TuTuA  &lt;NA&gt;  TuTuA_R flywire</span></span>
<span><span class="co">#&gt; 2 720575940621226846    L central TuTuA  &lt;NA&gt;  TuTuA_L flywire</span></span>
<span><span class="co">#&gt;                     key dendid group_k5</span></span>
<span><span class="co">#&gt; 1 fw:720575940622538520     15        5</span></span>
<span><span class="co">#&gt; 2 fw:720575940621226846     16        5</span></span></code></pre></div>
<p>The following code could help find the Flybase/Virtual Fly Brain anatomy ontology (FBbt) ids for these neurons:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">natmanager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span>pkgs <span class="op">=</span> <span class="st">'vfbr'</span><span class="op">)</span></span>
<span><span class="fu">vfbr</span><span class="fu">::</span><span class="fu">vfb_autocomplete_query</span><span class="op">(</span><span class="st">'TuTuB'</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"FBbt"</span>, <span class="va">short_form</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Gregory Jefferis.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
